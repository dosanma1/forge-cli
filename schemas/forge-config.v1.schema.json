{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://forge.dev/schemas/v1.0/config.json",
    "title": "Forge Configuration",
    "description": "Configuration file for Forge framework workspaces",
    "type": "object",
    "required": [
        "version",
        "workspace",
        "projects"
    ],
    "properties": {
        "version": {
            "type": "string",
            "description": "Configuration schema version",
            "const": "1"
        },
        "workspace": {
            "type": "object",
            "description": "Workspace-level configuration",
            "required": [
                "name",
                "forgeVersion"
            ],
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Workspace name (must be kebab-case)",
                    "pattern": "^[a-z][a-z0-9-]*$"
                },
                "forgeVersion": {
                    "type": "string",
                    "description": "Forge framework version (semver)",
                    "pattern": "^\\d+\\.\\d+\\.\\d+$"
                },
                "paths": {
                    "type": "object",
                    "description": "Workspace directory structure configuration",
                    "properties": {
                        "services": {
                            "type": "string",
                            "description": "Path to backend services directory",
                            "default": "backend/services"
                        },
                        "frontendApps": {
                            "type": "string",
                            "description": "Path to frontend applications directory",
                            "default": "frontend/projects"
                        },
                        "infrastructure": {
                            "type": "string",
                            "description": "Path to infrastructure configurations",
                            "default": "infra"
                        },
                        "shared": {
                            "type": "string",
                            "description": "Path to shared libraries",
                            "default": "shared"
                        },
                        "docs": {
                            "type": "string",
                            "description": "Path to documentation",
                            "default": "docs"
                        }
                    }
                },
                "github": {
                    "type": "object",
                    "description": "GitHub organization configuration",
                    "properties": {
                        "org": {
                            "type": "string",
                            "description": "GitHub organization name"
                        }
                    }
                }
            }
        },
        "projects": {
            "type": "object",
            "description": "Projects in the workspace",
            "additionalProperties": {
                "type": "object",
                "required": [
                    "name",
                    "type",
                    "root"
                ],
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "Project name (must be kebab-case)",
                        "pattern": "^[a-z][a-z0-9-]*$"
                    },
                    "type": {
                        "type": "string",
                        "description": "Project type",
                        "enum": [
                            "go-service",
                            "nestjs-service",
                            "angular-app",
                            "react-app",
                            "vue-app",
                            "shared-lib"
                        ]
                    },
                    "root": {
                        "type": "string",
                        "description": "Relative path to project root"
                    },
                    "tags": {
                        "type": "array",
                        "description": "Tags for categorizing projects",
                        "items": {
                            "type": "string"
                        }
                    },
                    "build": {
                        "type": "object",
                        "description": "Project-specific build configuration",
                        "properties": {
                            "goVersion": {
                                "type": "string",
                                "description": "Go version for this project"
                            },
                            "nodeVersion": {
                                "type": "string",
                                "description": "Node.js version for this project"
                            },
                            "registry": {
                                "type": "string",
                                "description": "Docker registry for this project"
                            },
                            "dockerfile": {
                                "type": "string",
                                "description": "Path to Dockerfile relative to project root",
                                "default": "Dockerfile"
                            },
                            "platforms": {
                                "type": "array",
                                "description": "Target platforms for multi-arch builds",
                                "items": {
                                    "type": "string",
                                    "enum": [
                                        "linux/amd64",
                                        "linux/arm64"
                                    ]
                                }
                            },
                            "buildCommand": {
                                "type": "string",
                                "description": "Custom build command"
                            },
                            "outputPath": {
                                "type": "string",
                                "description": "Build output directory (for frontend apps)"
                            }
                        }
                    },
                    "deploy": {
                        "type": "object",
                        "description": "Project deployment configuration",
                        "properties": {
                            "targets": {
                                "type": "array",
                                "description": "Supported deployment targets",
                                "items": {
                                    "type": "string",
                                    "enum": [
                                        "helm",
                                        "cloudrun",
                                        "firebase",
                                        "vercel",
                                        "cloudflare-pages"
                                    ]
                                }
                            },
                            "configPath": {
                                "type": "string",
                                "description": "Path to deployment configs relative to project root",
                                "default": "deploy"
                            },
                            "helm": {
                                "type": "object",
                                "description": "Helm deployment defaults",
                                "properties": {
                                    "port": {
                                        "type": "integer",
                                        "description": "Default service port"
                                    },
                                    "healthPath": {
                                        "type": "string",
                                        "description": "Health check endpoint path",
                                        "default": "/health"
                                    }
                                }
                            },
                            "cloudrun": {
                                "type": "object",
                                "description": "Cloud Run deployment defaults",
                                "properties": {
                                    "port": {
                                        "type": "integer",
                                        "description": "Container port"
                                    },
                                    "cpu": {
                                        "type": "string",
                                        "description": "CPU allocation"
                                    },
                                    "memory": {
                                        "type": "string",
                                        "description": "Memory allocation"
                                    },
                                    "concurrency": {
                                        "type": "integer",
                                        "description": "Max concurrent requests"
                                    },
                                    "minInstances": {
                                        "type": "integer",
                                        "description": "Minimum instances"
                                    },
                                    "maxInstances": {
                                        "type": "integer",
                                        "description": "Maximum instances"
                                    },
                                    "timeout": {
                                        "type": "string",
                                        "description": "Request timeout"
                                    },
                                    "healthPath": {
                                        "type": "string",
                                        "description": "Health check endpoint",
                                        "default": "/health"
                                    }
                                }
                            },
                            "firebase": {
                                "type": "object",
                                "description": "Firebase deployment configuration",
                                "properties": {
                                    "project": {
                                        "type": "string",
                                        "description": "Firebase project ID"
                                    },
                                    "site": {
                                        "type": "string",
                                        "description": "Firebase hosting site name"
                                    }
                                }
                            }
                        }
                    },
                    "local": {
                        "type": "object",
                        "description": "Local development configuration overrides",
                        "properties": {
                            "cloudrun": {
                                "type": "object",
                                "description": "Local Cloud Run configuration",
                                "properties": {
                                    "port": {
                                        "type": "integer",
                                        "description": "Local port mapping"
                                    },
                                    "env": {
                                        "type": "object",
                                        "description": "Local environment variables",
                                        "additionalProperties": {
                                            "type": "string"
                                        }
                                    }
                                }
                            },
                            "gke": {
                                "type": "object",
                                "description": "Local Kubernetes configuration",
                                "properties": {
                                    "port": {
                                        "type": "integer",
                                        "description": "Local port mapping"
                                    },
                                    "env": {
                                        "type": "object",
                                        "description": "Local environment variables",
                                        "additionalProperties": {
                                            "type": "string"
                                        }
                                    }
                                }
                            },
                            "firebase": {
                                "type": "object",
                                "description": "Local Firebase configuration",
                                "properties": {
                                    "port": {
                                        "type": "integer",
                                        "description": "Firebase emulator port"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "environments": {
            "type": "object",
            "description": "Deployment environments with default configurations",
            "additionalProperties": {
                "type": "object",
                "required": [
                    "name"
                ],
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "Environment name"
                    },
                    "description": {
                        "type": "string",
                        "description": "Environment description"
                    },
                    "target": {
                        "type": "string",
                        "description": "Default deployment target for this environment",
                        "enum": [
                            "gke",
                            "cloudrun",
                            "kind"
                        ]
                    },
                    "cluster": {
                        "type": "string",
                        "description": "Kubernetes/GKE cluster name"
                    },
                    "namespace": {
                        "type": "string",
                        "description": "Kubernetes namespace"
                    },
                    "registry": {
                        "type": "string",
                        "description": "Docker registry for this environment"
                    },
                    "region": {
                        "type": "string",
                        "description": "Cloud region"
                    }
                }
            }
        },
        "infrastructure": {
            "type": "object",
            "description": "Infrastructure configuration by provider",
            "properties": {
                "gke": {
                    "type": "object",
                    "description": "Google Kubernetes Engine configuration",
                    "properties": {
                        "projectId": {
                            "type": "string",
                            "description": "GCP project ID"
                        },
                        "clusterName": {
                            "type": "string",
                            "description": "GKE cluster name"
                        },
                        "region": {
                            "type": "string",
                            "description": "GKE cluster region"
                        },
                        "namespace": {
                            "type": "string",
                            "description": "Default namespace"
                        },
                        "workloadIdentityProvider": {
                            "type": "string",
                            "description": "Workload Identity provider"
                        },
                        "serviceAccount": {
                            "type": "string",
                            "description": "Service account email"
                        }
                    }
                },
                "kubernetes": {
                    "type": "object",
                    "description": "Generic Kubernetes configuration",
                    "properties": {
                        "cluster": {
                            "type": "string",
                            "description": "Cluster name"
                        },
                        "namespace": {
                            "type": "string",
                            "description": "Default namespace"
                        }
                    }
                },
                "cloudrun": {
                    "type": "object",
                    "description": "Google Cloud Run configuration",
                    "properties": {
                        "projectId": {
                            "type": "string",
                            "description": "GCP project ID"
                        },
                        "region": {
                            "type": "string",
                            "description": "Cloud Run region"
                        }
                    }
                },
                "firebase": {
                    "type": "object",
                    "description": "Firebase configuration",
                    "properties": {
                        "projects": {
                            "type": "object",
                            "description": "Firebase projects per environment",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    }
                },
                "kind": {
                    "type": "object",
                    "description": "Kind (local Kubernetes) configuration",
                    "properties": {
                        "configPath": {
                            "type": "string",
                            "description": "Path to kind config file"
                        }
                    }
                }
            }
        }
    }
}
